<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrolly</title>
</head>

<body>

    <!-- START SCROLLY -->

    <div class="scrolly">
        <style>
            @font-face {
                font-family: 'Balto';
                src: url('fonts/Balto-Book.woff') format('woff');
                font-weight: 400;
                font-style: normal;
            }
            
            @font-face {
                font-family: 'Balto';
                src: url('fonts/Balto-Bold.woff') format('woff');
                font-weight: 700;
                font-style: normal;
            }
            
            @font-face {
                font-family: 'Balto';
                src: url('fonts/Balto-Medium.woff') format('woff');
                font-weight: 500;
                font-style: normal;
            }
            
            @font-face {
                font-family: 'Balto';
                src: url('fonts/Balto-MediumItalic.woff') format('woff');
                font-weight: 500;
                font-style: italic;
            }

            .scrolly {
                width: 100%;
                position: relative;
                font-family: 'Balto', sans-serif;
                color: #474747;
            }

            .scrolly * {
                box-sizing: border-box;
                font-family: 'Balto', sans-serif;
            }

            .scrolly-bg {
                position: absolute;
                top: 0;
                left: 0;
                z-index: -1;
                width: 100%;
                height: 100%;
            }

            .scrolly .scrolly-section {
                height: 100vh;
                display: flex;
                justify-content: center;
                align-items: center;
                transition: background-color 0.5s ease;
                position: relative;
            }

            .scrolly .scrolly-background {
                position: absolute;
                top: 50vh;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 1000px;
                max-width: 100%;
                aspect-ratio: 16 / 9;
                z-index: -1;
                overflow: hidden;
            }

            .scrolly .scrolly-annotations {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                width: 100%;
                height: 100%;
                z-index: 3;
            }

            .scrolly .scrolly-background.fixed {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }

            .scrolly .scrolly-bg-image {
                width: 100%;
                height: 100%;
                object-fit: cover;
                transform-origin: center center;
            }

            .scrolly .scrolly-slide-inner {
                width: 1000px;
                max-width: 100%;
                display: inline-block;
                padding: 0 4em;
            }

            .scrolly .scrolly-row {
                display: flex;
                width: 100%;
            }
            
            .scrolly .scrolly-col {
                flex: 1;
                max-width: 33%;
                padding: 0 15px;
               
            }
            
            .scrolly .scrolly-row-2-up .scrolly-col {
                max-width: 50% !important
            }

            /* MARGINS AND PADDING */

            .scrolly .scrolly-mt-1 {
                margin-top: 1em;
            }

            .scrolly .scrolly-mt-2 {
                margin-top: 2em;
            }

            .scrolly .scrolly-mt-3 {
                margin-top: 3em;
            }

            .scrolly .scrolly-mt-4 {
                margin-top: 4em;
            }

            .scrolly .scrolly-mt-5 {
                margin-top: 5em;
            }

            .scrolly .scrolly-mb-1 {
                margin-bottom: 1em;
            }

            .scrolly .scrolly-mb-2 {
                margin-bottom: 2em;
            }

            .scrolly .scrolly-mb-3 {
                margin-bottom: 3em;
            }

            .scrolly .scrolly-mb-4 {
                margin-bottom: 4em;
            }

            .scrolly .scrolly-mb-5 {
                margin-bottom: 5em;
            }

            /* CUSTOMISATION STARTS HERE */

            .scrolly .scrolly-chart-container {
                width: 100%;
                height: 100%;
                position: relative;
            }

            .scrolly .scrolly-chart-legend {
                text-align: center;
            }
            
            .scrolly .scrolly-legend-item {
                display: inline-block;
            }
            
            .scrolly .scrolly-legend-color {
                width: 15px;
                height: 15px;
                display: inline-block;
                margin-right: 4px;
                border-radius: 2px;
            }
            
            .scrolly .scrolly-legend-text {
                display: inline-block;
            }
            
            .scrolly .scrolly-chart-label {
                font-size: 0.8em;
                text-align: center;
                margin-top: 1em;
            }

            .scrolly .scrolly-background {
                border: 1px solid #eee;
            }

            .scrolly .scrolly-slide-inner .scrolly-scrolly-caption-box {
                max-width: 400px;
            }

            .scrolly {
                font-size: 22px;
            }

            .scrolly h1 {
                font-size: 30px;
                margin: unset;
                margin-bottom: 0.8em;
                padding: unset;
                font-weight: 500;
                line-height: unset;
            }

            .scrolly .scrolly-primary {
                color: #F45946;
            }

            .scrolly .scrolly-fw-500 {
                font-weight: 500;
            }

            .scrolly .scrolly-big {
                font-size: 40px;
            }

            .scrolly .scrolly-annotation {
                position: absolute;
            }

            .scrolly-caption-box {
                background-color: rgba(255, 255, 255, 0.8);
                padding: 1em;
                border-radius: 5px;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
                max-width: 500px;
                text-align: left;
                margin: 0 auto;
            }

           

            /* ANNOTATIONS */

            .scrolly .scrolly-annotation-label {
                background-color: #F45946;
                color: #fff;
                font-family:'Courier New', Courier, monospace;
                padding: 0.1em 1em;
                font-size: 0.8em;
                font-weight: bold;
                box-shadow: 0 0 3px rgba(0, 0, 0, 0.8);
                text-align: center;
            }


            .scrolly-annotation-fs {
                top: 53%;
                right:22%;
            }

            .scrolly-annotation-kzn {
                top: 60%;
                right: 12%;
            }

            .scrolly-annotation-lp {
                top: 30%;
                right: 15%;
            }

            /* CHARTS */

            .scrolly-chart-1 {
                max-width: 80%;
                width: 600px;
                left: 50%;
                top: 10%;
                transform: translateX(-50%);
            }



        </style>
        <div class="scrolly-bg-color"></div>

        <div class="scrolly-background">
            <img src="img/toilets2.jpg" alt="Background Image" class="scrolly-bg-image">
            <div class="scrolly-annotations">
                <!-- <div class="scrolly-annotations scrolly-annotations3">
                    <div class="scrolly-annotation scrolly-annotation-label scrolly-annotation1 scrolly-annotation-fs">Free State</div>
                    <div class="scrolly-annotation scrolly-annotation-label scrolly-annotation2 scrolly-annotation-kzn">KZN</div>
                    <div class="scrolly-annotation scrolly-annotation-label scrolly-annotation3 scrolly-annotation-lp">Limpopo</div>
                </div> -->

                <div class="scrolly-annotation scrolly-chart-1">

                    <div class="scrolly-chart-legend scrolly-mt-2 scrolly-mb-2">
                        <div class="scrolly-legend-item">
                            <div class="scrolly-legend-color" style="background-color: #FFC107;"></div>
                            <div class="scrolly-legend-text">Inside</div>
                        </div>
                        <div class="scrolly-legend-item">
                            <div class="scrolly-legend-color" style="background-color: #FF5722;"></div>
                            <div class="scrolly-legend-text">Outside</div>
                        </div>
                        <div class="scrolly-legend-item">
                            <div class="scrolly-legend-color" style="background-color: #999999;"></div>
                            <div class="scrolly-legend-text">Both</div>
                        </div>
                    </div>

                    <div class="scrolly-row">
                        <div class="scrolly-col">
                            <div class="scrolly-chart-container">
                                <canvas id="fs"></canvas>
                                <div class="scrolly-chart-label">Free State</div>
                            </div>
                        </div>
                        <div class="scrolly-col">
                            <div class="scrolly-chart-container">
                                <canvas id="lp"></canvas>
                                <div class="scrolly-chart-label">Limpopo</div>
                            </div>
                        </div>
                        <div class="scrolly-col">
                            <div class="scrolly-chart-container">
                                <canvas id="kzn"></canvas>
                                <div class="scrolly-chart-label">KZN</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="scrolly-sections-container">

            <div class="scrolly-section scrolly-section1" data-background="img/toilets2.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <h1 class="scrolly-primary">What we did</h1>
                        <p>To better understand the state of <span class="scrolly-primary scrolly-fw-500">sanitation in our primary healthcare system</span>, we asked our network of <span class="scrolly-primary scrolly-fw-500">citizen journalists</span> to tell us what the bathrooms are like in their local clinics. We also also asked them to interview people who had recently used the clinics.</p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section2" data-background="img/map-base.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p>They visited <span class="scrolly-primary scrolly-fw-500 scrolly-big">31 clinics</span><br/>in <span class="scrolly-primary scrolly-fw-500 scrolly-big">3 provinces</span></p>
                    </div>
                </div>
            </div>
            <div class="scrolly-section scrolly-section3" data-background="img/map.jpg"></div>
            
            <div class="scrolly-section section4" data-background="img/map.jpg"></div>

            <div class="scrolly-section scrolly-section5" data-background="img/map.jpg"></div>
            
            <div class="scrolly-section scrolly-section6" data-background="img/map.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p>And interviewed<br/><span class="scrolly-primary scrolly-fw-500 scrolly-big">313 recent users</span><br/>of those clinics.</p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section7" data-background="img/toilets1.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box ">
                        <p>Interviewees were fairly <span class="scrolly-primary scrolly-fw-500">evenly split between age and gender</span>.</p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section8" data-background="img/toilets1.jpg"></div>

            <div class="scrolly-section scrolly-section9" data-background="img/outside-toilets.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p>Many clinics in Limpopo and KZN rely on <span class="scrolly-primary scrolly-fw-500">outdoor facilities</span>.</p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section10" data-background="img/pit-latrine1.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p><span class="scrolly-primary scrolly-fw-500 scrolly-big">Seven</span> clinics in Limpopo had some sort of <span class="scrolly-primary scrolly-fw-500">pit latrine</span>.</p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section11" data-background="img/disabled.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p>But while all the clinics we visited in the Free State had bathrooms inside the clinics, they were also the <span class="scrolly-primary scrolly-fw-500">least accessible to patients with a disability</span>.</p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section12" data-background="img/out-of-order.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p><span class="scrolly-primary scrolly-fw-500 scrolly-big">75.4%</span> of people we spoke to said that at some point, <span class="scrolly-primary scrolly-fw-500">the toilets had been out of order</span> when then visited the clinic.</p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section13" data-background="img/out-of-order.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p>Broken bathrooms were experienced much more in <span class="scrolly-primary scrolly-fw-500">KZN</span> and <span class="scrolly-primary scrolly-fw-500">Limpopo</span> than in the Free State.</p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section14" data-background="img/no-toilet-paper.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p>Even when patients could visit the bathroom, however, both male and female toilets were <span class="scrolly-primary scrolly-fw-500">unlikely to be stocked  with basics such as toilet paper or soap</span>.</p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section15" data-background="img/no-toilet-paper.jpg">
                <div class="scrolly-slide-inner">
                </div>
            </div>

            <div class="scrolly-section scrolly-section16" data-background="img/no-soap.jpg">
                <div class="scrolly-slide-inner">
                </div>
            </div>

            <div class="scrolly-section scrolly-section17" data-background="img/dirty-toilets.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p>Unsurprising, then, that our CJs found the state of the toilets to be <span class="scrolly-primary scrolly-fw-500">very unhygienic</span>, with urine or feacal matter on the seats in 13 clinics, including nine in Limpopo.</p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section17" data-background="img/queue.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p>In addition to the basic state of hygiene, in some larger facilities our reporters witnessed people queuing for up to an hour to use the bathroom. </p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section18" data-background="img/no-lock.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p>No wonder then that so many people told us that they didn’t feel safe using the toilets. </p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section19" data-background="img/no-lock.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p>This included more than half of all women interviewed. Surprisingly, two thirds of 18-25-year-olds said they didn’t feel safe, compared to around 40% of those aged 26-40 or older than 60.</p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section20" data-background="img/people1.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p>Apart from the obvious implications to health, and our expectations of germ control in a medical centre, 83 patients we spoke to told us that the state of the bathrooms put them off visiting again. The implications of this - people avoiding primary health care facilities - are severe.</p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section21" data-background="img/toilets2.jpg">
                <div class="scrolly-slide-inner">
                    <div class="scrolly-caption-box">
                        <p>And all for the sake of a usable bathroom.</p>
                    </div>
                </div>
            </div>

            <div class="scrolly-section scrolly-section22" data-background="img/toilets2.jpg"></div>
            <div class="scrolly-section scrolly-section23" data-background="img/toilets2.jpg"></div>


        </div>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.4/gsap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.4/ScrollTrigger.min.js"></script>
        <script>
            function updateBackgroundImage(src) {
                const bgImage = document.querySelector('.scrolly-bg-image');
                bgImage.src = src;
            }
            

            gsap.registerPlugin(ScrollTrigger);
            gsap.registerPlugin(EndArrayPlugin);

            document.querySelectorAll('.scrolly-section').forEach((section, index) => {
                const background = section.getAttribute('data-background');

                ScrollTrigger.create({
                    trigger: section,
                    start: 'top 50%',
                    onEnter: () => {
                        updateBackgroundImage(background);
                    },
                    onLeaveBack: () => {
                        const prevSection = document.querySelectorAll('.scrolly-section')[index - 1];
                        const prevBackground = prevSection ? prevSection.getAttribute('data-background') : background;
                        updateBackgroundImage(prevBackground);
                    }
                });
            });

            gsap.registerPlugin(ScrollTrigger);

            const background = document.querySelector('.scrolly-background');

            ScrollTrigger.create({
                trigger: '.scrolly-section1',
                start: 'top top',
                endTrigger: '.scrolly-section23',
                end: 'bottom bottom',
                toggleClass: { targets: background, className: 'fixed' },
            });

            /// CUSTOMISATION STARTS HERE

            /// PINS

            // PIN SECTION 2
            ScrollTrigger.create({
                trigger: '.scrolly-section2 .scrolly-slide-inner',
                pin: true,
                start: 'center center',
                endTrigger: '.scrolly-section5',
                end: 'top top',
                pinSpacing: false
            });

            ScrollTrigger.create({
                trigger: '.scrolly-section7 .scrolly-slide-inner',
                pin: true,
                start: 'center center',
                endTrigger: '.scrolly-section8',
                end: 'top top',
                pinSpacing: false
            });

            // FINAL SECTION

            ScrollTrigger.create({
                trigger: '.scrolly-section21 .scrolly-slide-inner',
                pin: true,
                start: 'center center',
                end: 'top top',
                pinSpacing: false
            });



            /// ANNOTATIONS

            /*gsap.fromTo(
                ".annotations3 .annotation1, .annotations3 .annotation2, .annotations3 .annotation3",
                { opacity: 0 },
                {
                    opacity: 1,
                    ease: "none",
                    scrollTrigger: {
                        trigger: ".section4",
                        start: "top center",
                        end: "bottom center",
                        scrub: true,
                    },
                }
            );

            gsap.fromTo(
                ".annotations3",
                { opacity: 1 },
                {
                    opacity: 0,
                    ease: "none",
                    scrollTrigger: {
                        trigger: ".section6",
                        start: "bottom bottom",
                        end: "top bottom",
                        scrub: true,
                    },
                }
            );*/

            

            /// ZOOMS
            
            gsap.to(
                ".scrolly-bg-image",
                {
                    scale: 1.2,
                    x: -100,
                    ease: "none",
                    scrollTrigger: {
                        trigger: ".scrolly-section3",
                        start: "top center",
                        end: "bottom center",
                        scrub: true,
                    },
                }
            );

            gsap.to(
                ".scrolly-bg-image",
                {
                    scale: 1,
                    x: 0,
                    ease: "none",
                    scrollTrigger: {
                        trigger: ".scrolly-section7",
                        start: "top center",
                        end: "bottom center",
                        scrub: true,
                    },
                }
            );

            // CHARTS

            var doughnut_chart_options = {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        display: false  
                    }
                },
                borderWidth: 1
            };

            // INSIDE AND OUTSIDE BREAKDOWN

            const fs_ctx = document.getElementById('fs').getContext('2d');
            const fs = new Chart(fs_ctx, {
                type: 'doughnut',
                options: doughnut_chart_options,
                data: {
                    labels: ['Both', 'Inside', 'Outside'],
                    datasets: [{
                        data: [0, 0, 0],  
                        backgroundColor: ['#999999','#ffd06c', '#ff3d3b']
                    }]
                }
            });

            const lp_ctx = document.getElementById('lp').getContext('2d');
            const lp = new Chart(lp_ctx, {
                type: 'doughnut',
                options: doughnut_chart_options,
                data: {
                    labels: ['Both', 'Inside', 'Outside'],
                    datasets: [{
                        data: [0, 0, 0],  
                        backgroundColor: ['#999999','#ffd06c', '#ff3d3b']
                    }]
                }
            });

            const kzn_ctx = document.getElementById('kzn').getContext('2d');
            const kzn = new Chart(kzn_ctx, {
                type: 'doughnut',
                options: doughnut_chart_options,
                data: {
                    labels: ['Both', 'Inside', 'Outside'],
                    datasets: [{
                        data: [0, 0, 0],  
                        backgroundColor: ['#999999','#ffd06c', '#ff3d3b']
                    }]
                }
            });

            // CHART ANIMATIONS
            
            
            const fs_values = [33, 33, 34];
            const lp_values = [20, 70, 10];
            const kzn_values = [70, 20, 10];

            gsap.timeline({
                scrollTrigger: {
                    trigger: ".scrolly-section9",
                    start: "top bottom",
                    end: "top center",
                    scrub: true
                }
                })
                .fromTo(
                    ".scrolly-chart-1",
                    { opacity: 0 },
                    { opacity: 1, ease: "none" }
                )
                .to(fs.data.datasets[0].data, { endArray: fs_values, ease: "none", onUpdate: function() { fs.update(); } }, 0)
                .to(lp.data.datasets[0].data, { endArray: lp_values, ease: "none", onUpdate: function() { lp.update(); } }, 0)
                .to(kzn.data.datasets[0].data, { endArray: kzn_values, ease: "none", onUpdate: function() { kzn.update(); } }, 0)
            
            const fs_values2 = [10, 20, 70];
            const lp_values2 = [10, 40, 50];
            const kzn_values2 = [5, 5, 90];

            gsap
            .timeline({
                scrollTrigger: {
                    trigger: ".scrolly-section12",
                    start: "top center",
                    end: "top top",
                    scrub: true
                }
            })
            .to(fs.data.datasets[0].data, { endArray: fs_values2, ease: "none", onUpdate: function() { fs.update(); } }, 0)
            .to(lp.data.datasets[0].data, { endArray: lp_values2, ease: "none", onUpdate: function() { lp.update(); } }, 0)
            .to(kzn.data.datasets[0].data, { endArray: kzn_values2, ease: "none", onUpdate: function() { kzn.update(); } }, 0)
        

        </script>
    </div>

    <!-- END SCROLLY -->

           
  


</body>

</html>